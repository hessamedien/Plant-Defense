<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crazy Dave's Adventure</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/sahel-font@v3.4.0/dist/font-face.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/shabnam-font@v5.0.1/dist/font-face.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/parastoo-font@v1.0.3/dist/font-face.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/tanha-font@v0.10/dist/font-face.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/gandom-font@v0.5.1/dist/font-face.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #8BC34A;
            --secondary-color: #FF9800;
            --accent-color: #4CAF50;
            --text-color: #333;
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --header-height: 60px;
            --footer-height: 40px;
            --font-main: 'Vazirmatn', 'Sahel', sans-serif;
            --font-title: 'Gandom', 'Vazirmatn', sans-serif;
            --lawn-green: #87C159;
            --lawn-dark-green: #6B9E3F;
            --sun-yellow: #FFEB3B;
            --pea-green: #4CAF50;
            --zombie-green: #5D8C5D;
        }

        .theme-dark {
            --primary-color: #689F38;
            --secondary-color: #FF5722;
            --accent-color: #388E3C;
            --text-color: #f5f5f5;
            --bg-color: #2E2E2E;
            --card-bg: #424242;
            --lawn-green: #5A7D3C;
            --lawn-dark-green: #4A6531;
        }

        .theme-zombie {
            --primary-color: #795548;
            --secondary-color: #FF5722;
            --accent-color: #5D4037;
            --text-color: #f5f5f5;
            --bg-color: #3E2723;
            --card-bg: #5D4037;
            --lawn-green: #5D4037;
            --lawn-dark-green: #4E342E;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: all 0.3s ease;
            overflow-x: hidden;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%2387C159"/><path d="M0 0L100 100M100 0L0 100" stroke="%236B9E3F" stroke-width="2"/></svg>');
            background-size: 200px 200px;
        }

        body.english {
            direction: ltr;
            text-align: left;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Language Selection Screen */
        #language-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--lawn-green) 0%, var(--accent-color) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
        }

        .language-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            width: 300px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .language-option:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .language-flag {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .language-name {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 10px;
        }

        .language-desc {
            font-size: 1.2rem;
            color: var(--text-color);
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--lawn-green) 0%, var(--accent-color) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
        }

        .lawn-stripes {
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255,255,255,0.1) 10px,
                rgba(255,255,255,0.1) 20px
            );
        }

        #loading-screen h1 {
            font-family: var(--font-title);
            font-size: 3.5rem;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0 #000;
            animation: bounce 2s infinite;
            color: var(--sun-yellow);
        }

        #loading-screen h2 {
            font-size: 1.8rem;
            animation: fadeInOut 2s infinite;
            margin-bottom: 30px;
            text-align: center;
            max-width: 80%;
        }

        .loading-bar-container {
            width: 400px;
            height: 30px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            margin-top: 20px;
            overflow: hidden;
            border: 2px solid #000;
            position: relative;
        }

        .loading-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--sun-yellow), var(--secondary-color));
            border-radius: 15px;
            animation: loading 5s forwards;
            position: relative;
            overflow: hidden;
        }

        .loading-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shine 1.5s infinite;
        }

        .zombie-head {
            position: absolute;
            width: 40px;
            height: 40px;
            background-color: var(--zombie-green);
            border-radius: 50%;
            top: -5px;
            left: 0;
            transform: translateX(-50%);
            transition: left 5s linear;
            z-index: 2;
            border: 2px solid #000;
        }

        .zombie-head::before, .zombie-head::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #000;
            border-radius: 50%;
            top: 12px;
        }

        .zombie-head::before {
            left: 8px;
        }

        .zombie-head::after {
            right: 8px;
        }

        .zombie-mouth {
            position: absolute;
            width: 20px;
            height: 8px;
            background-color: #000;
            border-radius: 0 0 10px 10px;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
        }

        @keyframes loading {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Main Menu */
        #main-menu {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-top: 20px;
            border: 5px solid var(--lawn-dark-green);
            position: relative;
            overflow: hidden;
        }

        #main-menu::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60"><circle cx="30" cy="30" r="25" fill="%23FFEB3B" opacity="0.1"/></svg>');
            z-index: 0;
        }

        .logo {
            font-family: var(--font-title);
            font-size: 5rem;
            color: var(--secondary-color);
            text-shadow: 4px 4px 0 #000, 6px 6px 0 rgba(0,0,0,0.2);
            margin-bottom: 30px;
            animation: glow 2s infinite alternate;
            position: relative;
            z-index: 1;
            letter-spacing: 2px;
        }

        .logo-subtitle {
            font-family: var(--font-main);
            font-size: 1.5rem;
            color: var(--text-color);
            margin-top: -20px;
            margin-bottom: 40px;
            text-shadow: 1px 1px 0 #FFF;
        }

        @keyframes glow {
            from { 
                text-shadow: 4px 4px 0 #000, 6px 6px 0 rgba(0,0,0,0.2), 0 0 10px var(--sun-yellow); 
            }
            to { 
                text-shadow: 4px 4px 0 #000, 6px 6px 0 rgba(0,0,0,0.2), 0 0 20px var(--sun-yellow), 0 0 30px var(--secondary-color); 
            }
        }

        .menu-button {
            display: block;
            width: 80%;
            max-width: 350px;
            margin: 15px auto;
            padding: 18px;
            background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
            color: white;
            border: none;
            border-radius: 15px;
            font-family: var(--font-main);
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 0 var(--lawn-dark-green), 0 10px 20px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .menu-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .menu-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 0 var(--lawn-dark-green), 0 15px 20px rgba(0,0,0,0.3);
        }

        .menu-button:hover::before {
            left: 100%;
        }

        .menu-button:active {
            transform: translateY(0);
            box-shadow: 0 3px 0 var(--lawn-dark-green), 0 5px 10px rgba(0,0,0,0.2);
        }

        /* Story Screen */
        #story-screen {
            display: none;
        }

        .lawn-background {
            background-color: var(--lawn-green);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            min-height: 500px;
            border: 5px solid var(--lawn-dark-green);
            overflow: hidden;
        }

        .lawn-background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 19px,
                    rgba(0,0,0,0.05) 19px,
                    rgba(0,0,0,0.05) 20px
                ),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 19px,
                    rgba(0,0,0,0.05) 19px,
                    rgba(0,0,0,0.05) 20px
                );
            pointer-events: none;
        }

        .page-header {
            text-align: center;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
            position: relative;
        }

        .page-header h2 {
            font-family: var(--font-title);
            font-size: 2.2rem;
            color: var(--secondary-color);
            text-shadow: 2px 2px 0 #000;
            letter-spacing: 1px;
        }

        .page-content {
            background-color: rgba(255, 255, 255, 0.85);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid var(--accent-color);
            font-size: 1.1rem;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        .page-number {
            position: absolute;
            bottom: 15px;
            right: 25px;
            font-size: 0.9rem;
            color: var(--text-color);
            opacity: 0.7;
            background: rgba(255,255,255,0.7);
            padding: 5px 10px;
            border-radius: 10px;
            z-index: 2;
        }

        body.english .page-number {
            right: auto;
            left: 25px;
        }

        .character-image {
            float: right;
            margin-left: 20px;
            margin-bottom: 10px;
            width: 120px;
            height: 120px;
            border-radius: 10px;
            border: 3px solid var(--secondary-color);
            background-color: var(--card-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
        }

        body.english .character-image {
            float: left;
            margin-left: 0;
            margin-right: 20px;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 30px;
        }

        .choice-button {
            padding: 15px;
            background: linear-gradient(to bottom, var(--secondary-color), #E65100);
            color: white;
            border: none;
            border-radius: 10px;
            font-family: var(--font-main);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: right;
            box-shadow: 0 4px 0 #B71C1C;
            position: relative;
            overflow: hidden;
        }

        body.english .choice-button {
            text-align: left;
        }

        .choice-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .choice-button:hover {
            transform: translateX(-10px);
            box-shadow: 0 6px 0 #B71C1C;
        }

        body.english .choice-button:hover {
            transform: translateX(10px);
        }

        .choice-button:hover::before {
            left: 100%;
        }

        /* Navigation */
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .nav-button {
            padding: 12px 25px;
            background: linear-gradient(to bottom, var(--accent-color), var(--primary-color));
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-family: var(--font-main);
            font-size: 1.1rem;
            box-shadow: 0 4px 0 var(--lawn-dark-green);
            transition: all 0.2s;
        }

        .nav-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 0 var(--lawn-dark-green);
        }

        .nav-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 0 var(--lawn-dark-green);
        }

        /* Settings */
        #settings-screen {
            display: none;
        }

        .setting-option {
            margin-bottom: 20px;
            background: rgba(255,255,255,0.7);
            padding: 15px;
            border-radius: 10px;
        }

        .setting-option label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .setting-option select, .setting-option input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid var(--primary-color);
            font-family: var(--font-main);
            font-size: 1rem;
        }

        .setting-option input[type="range"] {
            -webkit-appearance: none;
            height: 15px;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            border-radius: 10px;
            outline: none;
        }

        .setting-option input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            background: var(--secondary-color);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #000;
        }

        /* Floating Button */
        .floating-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(to bottom, var(--secondary-color), #E65100);
            color: white;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 100;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.english .floating-button {
            right: auto;
            left: 20px;
        }

        .floating-button:hover {
            transform: scale(1.1) rotate(-15deg);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        body.english .floating-button:hover {
            transform: scale(1.1) rotate(15deg);
        }

        /* Credits Screen */
        #credits-screen {
            display: none;
            text-align: center;
        }

        .credits-content {
            max-height: 70vh;
            overflow-y: auto;
            padding: 25px;
            background-color: var(--card-bg);
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 3px solid var(--primary-color);
            text-align: right;
        }

        body.english .credits-content {
            text-align: left;
        }

        .credits-content h3 {
            color: var(--secondary-color);
            text-align: center;
            margin-bottom: 20px;
            font-family: var(--font-title);
            font-size: 2rem;
        }

        .credits-content p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .credits-content a {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: bold;
        }

        .credits-content a:hover {
            text-decoration: underline;
        }

        /* Table of Contents */
        #toc-screen {
            display: none;
        }

        .toc-item {
            padding: 15px;
            border-bottom: 2px solid var(--primary-color);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1rem;
            background: rgba(255,255,255,0.7);
            margin-bottom: 5px;
            border-radius: 8px;
        }

        .toc-item:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateX(-10px);
        }

        body.english .toc-item:hover {
            transform: translateX(10px);
        }

        /* Stats Screen */
        #stats-screen {
            display: none;
        }

        .stats-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid var(--accent-color);
        }

        .stat-item {
            text-align: center;
            margin: 10px;
            flex: 1 0 30%;
            min-width: 150px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--secondary-color);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-color);
        }

        /* Plant and Zombie Animations */
        .sun {
            position: absolute;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, var(--sun-yellow) 40%, #FFC107);
            border-radius: 50%;
            box-shadow: 0 0 20px var(--sun-yellow);
            animation: float 10s infinite ease-in-out;
            z-index: 0;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .pea {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: var(--pea-green);
            border-radius: 50%;
            z-index: 1;
        }

        /* Ending Screen */
        .ending-message {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            margin: 20px 0;
            border: 3px solid var(--secondary-color);
        }

        .ending-title {
            font-family: var(--font-title);
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 20px;
            text-shadow: 2px 2px 0 #000;
        }

        .ending-image {
            font-size: 6rem;
            margin: 20px 0;
        }

        /* Language Toggle */
        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 15px;
            cursor: pointer;
            font-family: var(--font-main);
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 150;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        body.english .language-toggle {
            right: auto;
            left: 20px;
        }

        /* Font Selection */
        .font-option {
            display: inline-block;
            width: 30%;
            margin: 5px;
            padding: 10px;
            background: rgba(255,255,255,0.7);
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .font-option:hover {
            background: var(--primary-color);
            color: white;
        }

        .font-option.active {
            background: var(--secondary-color);
            color: white;
        }

        /* Sound Controls */
        .sound-control {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .sound-control label {
            flex: 1;
        }

        .sound-control input[type="range"] {
            flex: 2;
        }

        .sound-control span {
            flex: 0.5;
            text-align: center;
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }
            #story-screen, #story-screen * {
                visibility: visible;
            }
            #story-screen {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .navigation, .floating-button {
                display: none !important;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            .logo {
                font-size: 3.5rem;
            }
            .lawn-background {
                padding: 15px;
            }
            .character-image {
                float: none;
                margin: 0 auto 15px;
                display: block;
            }
            .menu-button {
                width: 90%;
                padding: 15px;
            }
            .stats-container {
                flex-direction: column;
            }
            .font-option {
                width: 45%;
            }
            .language-option {
                width: 250px;
            }
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 2.5rem;
            }
            .logo-subtitle {
                font-size: 1.2rem;
            }
            .page-header h2 {
                font-size: 1.8rem;
            }
            .page-content {
                padding: 15px;
            }
            .ending-title {
                font-size: 2rem;
            }
            .ending-image {
                font-size: 4rem;
            }
            .font-option {
                width: 100%;
            }
            .language-option {
                width: 200px;
                padding: 20px;
            }
            .language-flag {
                font-size: 3rem;
            }
            .language-name {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Language Selection Screen -->
    <div id="language-screen">
        <h1>Select Language | ÿßŸÜÿ™ÿÆÿßÿ® ÿ≤ÿ®ÿßŸÜ</h1>
        <div class="language-option" onclick="selectLanguage('en')">
            <div class="language-flag">üá∫üá∏</div>
            <div class="language-name">English</div>
            <div class="language-desc">Play in English</div>
        </div>
        <div class="language-option" onclick="selectLanguage('fa')">
            <div class="language-flag">üáÆüá∑</div>
            <div class="language-name">ŸÅÿßÿ±ÿ≥€å</div>
            <div class="language-desc">ÿ®ÿßÿ≤€å ÿ®Ÿá ÿ≤ÿ®ÿßŸÜ ŸÅÿßÿ±ÿ≥€å</div>
        </div>
    </div>

    <!-- Loading Screen -->
    <div id="loading-screen" style="display: none;">
        <div class="lawn-stripes"></div>
        <h1 id="loading-title">Crazy Dave's Adventure</h1>
        <h2 id="loading-subtitle">A Fan Made Text Based Game</h2>
        <div class="loading-bar-container">
            <div class="loading-bar"></div>
            <div class="zombie-head"></div>
        </div>
    </div>

    <!-- Language Toggle Button -->
    <button class="language-toggle" onclick="toggleLanguage()" style="display: none;">
        <span id="lang-flag">üá∫üá∏</span>
        <span id="lang-text">EN</span>
    </button>

    <!-- Main Menu -->
    <div id="main-menu" class="container" style="display: none;">
        <div class="logo" id="main-logo">Crazy Dave's Adventure</div>
        <div class="logo-subtitle" id="main-subtitle">A Fan Made Text Based Game</div>
        <button class="menu-button" onclick="startNewGame()" id="menu-new-game">Start New Adventure</button>
        <button class="menu-button" onclick="continueGame()" id="menu-continue">Continue Adventure</button>
        <button class="menu-button" onclick="showScreen('toc-screen')" id="menu-toc">Table of Contents</button>
        <button class="menu-button" onclick="showScreen('stats-screen')" id="menu-stats">Player Stats</button>
        <button class="menu-button" onclick="showScreen('settings-screen')" id="menu-settings">Settings</button>
        <button class="menu-button" onclick="showScreen('credits-screen')" id="menu-credits">Credits</button>
        <button class="menu-button" onclick="exitApp()" id="menu-exit">Exit</button>
        
        <!-- Decorative suns -->
        <div class="sun" style="top: 10%; left: 10%;"></div>
        <div class="sun" style="top: 20%; right: 15%;"></div>
        <div class="sun" style="bottom: 15%; left: 20%;"></div>
    </div>

    <!-- Story Screen -->
    <div id="story-screen" class="container">
        <div class="lawn-background">
            <div class="page-header">
                <h2 id="story-title">Chapter 1: The Zombie Invasion Begins!</h2>
            </div>
            <div class="stats-container" id="current-stats">
                <div class="stat-item">
                    <div class="stat-value" id="stat-sun">0</div>
                    <div class="stat-label" id="stat-sun-label">Sun Power</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="stat-zombies">0</div>
                    <div class="stat-label" id="stat-zombies-label">Zombies Defeated</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="stat-plants">0</div>
                    <div class="stat-label" id="stat-plants-label">Plants Planted</div>
                </div>
            </div>
            <div class="page-content" id="story-content">
                <div class="character-image">üåª</div>
                <p id="story-text-1">Welcome to Neighborville, the most peaceful town in the whole world! The sun is shining, birds are singing, and flowers are blooming everywhere. But wait... what's that strange groaning sound?</p>
                <p id="story-text-2">Oh no! Zombies are coming from the west! They're slowly shuffling toward your house, and they look hungry... for brains!</p>
                <p id="story-text-3">Suddenly, your eccentric neighbor Crazy Dave appears in his souped-up convertible. "Waffles! We need plants! Hungry plants!" he shouts, tossing you a packet of seeds.</p>
                <p id="story-text-4">What do you do first?</p>
            </div>
            <div class="choices" id="story-choices">
                <button class="choice-button" onclick="makeChoice(1)" id="choice-1">Plant Sunflowers to collect sunshine for more plants</button>
                <button class="choice-button" onclick="makeChoice(2)" id="choice-2">Immediately plant Peashooters to defend against the first zombie</button>
                <button class="choice-button" onclick="makeChoice(3)" id="choice-3">Search for Crazy Dave to ask for more advice</button>
            </div>
            <div class="page-number">Page <span id="current-page">1</span></div>
            
            <!-- Decorative elements -->
            <div class="sun" style="top: 50px; right: 50px;"></div>
            <div class="pea" style="top: 120px; left: 100px;"></div>
            <div class="pea" style="top: 180px; left: 150px;"></div>
        </div>
        <div class="navigation">
            <button class="nav-button" onclick="previousPage()" id="nav-prev">Previous</button>
            <button class="nav-button" onclick="saveGame()" id="nav-save">Save Game</button>
            <button class="nav-button" onclick="nextPage()" id="nav-next">Next</button>
        </div>
    </div>

    <!-- Stats Screen -->
    <div id="stats-screen" class="container" style="display: none;">
        <div class="lawn-background">
            <div class="page-header">
                <h2 id="stats-title">Player Statistics</h2>
            </div>
            <div class="stats-container">
                <div class="stat-item">
                    <div class="stat-value" id="total-sun">0</div>
                    <div class="stat-label" id="total-sun-label">Total Sun Collected</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="total-zombies">0</div>
                    <div class="stat-label" id="total-zombies-label">Total Zombies Defeated</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="total-plants">0</div>
                    <div class="stat-label" id="total-plants-label">Total Plants Planted</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="total-choices">0</div>
                    <div class="stat-label" id="total-choices-label">Decisions Made</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="total-pages">0</div>
                    <div class="stat-label" id="total-pages-label">Pages Read</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="game-score">0</div>
                    <div class="stat-label" id="game-score-label">Adventure Score</div>
                </div>
            </div>
            <div class="page-content">
                <h3 id="plant-collection-title">Plant Collection</h3>
                <div id="plant-collection">
                    <!-- Plant collection will be populated by JavaScript -->
                </div>
            </div>
        </div>
        <div class="navigation">
            <button class="nav-button" onclick="showScreen('main-menu')" id="stats-back">Back to Menu</button>
        </div>
    </div>

    <!-- Table of Contents -->
    <div id="toc-screen" class="container" style="display: none;">
        <div class="lawn-background">
            <div class="page-header">
                <h2 id="toc-title">Table of Contents</h2>
            </div>
            <div class="page-content">
                <div class="toc-item" onclick="goToPage(0)" id="toc-0">Preface: The Calm Before the Storm</div>
                <div class="toc-item" onclick="goToPage(1)" id="toc-1">Introduction: Meet Crazy Dave</div>
                <div class="toc-item" onclick="goToPage(2)" id="toc-2">Chapter 1: The Zombie Invasion Begins!</div>
                <div class="toc-item" onclick="goToPage(3)" id="toc-3">Chapter 2: Meeting the Plant Army</div>
                <div class="toc-item" onclick="goToPage(4)" id="toc-4">Chapter 3: Your First Defense Line</div>
                <div class="toc-item" onclick="goToPage(5)" id="toc-5">Chapter 4: The Wall-nut Strategy</div>
                <div class="toc-item" onclick="goToPage(6)" id="toc-6">Chapter 5: Cherry Bomb Surprise</div>
                <div class="toc-item" onclick="goToPage(7)" id="toc-7">Chapter 6: The Night Shift Begins</div>
                <div class="toc-item" onclick="goToPage(8)" id="toc-8">Chapter 7: Mushroom Allies</div>
                <div class="toc-item" onclick="goToPage(9)" id="toc-9">Chapter 8: Pool Defense Tactics</div>
                <div class="toc-item" onclick="goToPage(10)" id="toc-10">Chapter 9: The Roof Finale</div>
                <div class="toc-item" onclick="goToPage(11)" id="toc-11">Chapter 10: Dr. Zomboss's Revenge</div>
                <div class="toc-item" onclick="goToPage(12)" id="toc-12">Epilogue: A Hero's Reward</div>
                <div class="toc-item" onclick="goToPage(13)" id="toc-13">Bonus Chapter: The Secret Garden</div>
                <div class="toc-item" onclick="goToPage(14)" id="toc-14">Reviews and Critiques</div>
                <div class="toc-item" onclick="goToPage(15)" id="toc-15">Acknowledgments</div>
            </div>
        </div>
        <div class="navigation">
            <button class="nav-button" onclick="showScreen('main-menu')" id="toc-back">Back to Menu</button>
        </div>
    </div>

    <!-- Settings Screen -->
    <div id="settings-screen" class="container" style="display: none;">
        <div class="lawn-background">
            <div class="page-header">
                <h2 id="settings-title">Settings</h2>
            </div>
            <div class="page-content">
                <div class="setting-option">
                    <label for="theme-select" id="theme-label">Theme:</label>
                    <select id="theme-select" onchange="changeTheme(this.value)">
                        <option value="default">Default (Green)</option>
                        <option value="dark">Dark Mode</option>
                        <option value="zombie">Zombie Theme</option>
                    </select>
                </div>
                
                <div class="setting-option">
                    <label id="font-label">Font:</label>
                    <div>
                        <div class="font-option active" onclick="changeFont('Vazirmatn')" style="font-family: 'Vazirmatn';" id="font-vazir">Vazirmatn</div>
                        <div class="font-option" onclick="changeFont('Sahel')" style="font-family: 'Sahel';" id="font-sahel">Sahel</div>
                        <div class="font-option" onclick="changeFont('Shabnam')" style="font-family: 'Shabnam';" id="font-shabnam">Shabnam</div>
                        <div class="font-option" onclick="changeFont('Parastoo')" style="font-family: 'Parastoo';" id="font-parastoo">Parastoo</div>
                        <div class="font-option" onclick="changeFont('Tanha')" style="font-family: 'Tanha';" id="font-tanha">Tanha</div>
                        <div class="font-option" onclick="changeFont('Gandom')" style="font-family: 'Gandom';" id="font-gandom">Gandom</div>
                    </div>
                </div>
                
                <div class="setting-option">
                    <label for="font-size" id="font-size-label">Font Size:</label>
                    <input type="range" id="font-size" min="14" max="24" value="16" onchange="changeFontSize(this.value)">
                    <span id="font-size-value">16px</span>
                </div>
                
                <div class="setting-option">
                    <label id="sound-label">Sounds:</label>
                    <div class="sound-control">
                        <label id="bg-music-label">Background Music:</label>
                        <input type="range" id="bg-music" min="0" max="100" value="50" onchange="changeVolume('bgMusic', this.value)">
                        <span id="bg-music-value">50%</span>
                    </div>
                    <div class="sound-control">
                        <label id="sfx-label">Sound Effects:</label>
                        <input type="range" id="sfx-volume" min="0" max="100" value="70" onchange="changeVolume('sfx', this.value)">
                        <span id="sfx-volume-value">70%</span>
                    </div>
                    <div class="sound-control">
                        <label id="plant-sounds-label">Plant Sounds:</label>
                        <input type="range" id="plant-sounds" min="0" max="100" value="80" onchange="changeVolume('plants', this.value)">
                        <span id="plant-sounds-value">80%</span>
                    </div>
                </div>
                
                <div class="setting-option">
                    <label for="auto-save" id="auto-save-label">Auto Save:</label>
                    <select id="auto-save" onchange="toggleAutoSave(this.value)">
                        <option value="on">Enabled</option>
                        <option value="off">Disabled</option>
                    </select>
                </div>
                
                <div class="setting-option">
                    <button class="menu-button" onclick="testSounds()" style="background: linear-gradient(to bottom, #9C27B0, #7B1FA2);" id="test-sounds">Test Sounds</button>
                </div>
            </div>
        </div>
        <div class="navigation">
            <button class="nav-button" onclick="resetSettings()" id="settings-reset">Reset Settings</button>
            <button class="nav-button" onclick="showScreen('main-menu')" id="settings-back">Back to Menu</button>
        </div>
    </div>

    <!-- Credits Screen -->
    <div id="credits-screen" class="container" style="display: none;">
        <div class="lawn-background">
            <div class="page-header">
                <h2 id="credits-title">Credits</h2>
            </div>
            <div class="credits-content">
                <h3 id="credits-game-title">Plants vs. Zombies: Crazy Dave's Adventure</h3>
                <p id="credits-desc">An interactive storybook experience based on the popular game Plants vs. Zombies by PopCap Games.</p>
                
                <h3 id="credits-dev-team">Development Team</h3>
                <p id="credits-story"><strong>Story & Design:</strong> Fan Development Team</p>
                <p id="credits-programming"><strong>Programming:</strong> Fan Development Team</p>
                <p id="credits-art"><strong>Art Direction:</strong> Fan Development Team</p>
                
                <h3 id="credits-thanks">Special Thanks</h3>
                <p id="credits-thanks-1">To the original creators of Plants vs. Zombies for inspiring this project.</p>
                <p id="credits-thanks-2">To all the plants who bravely gave their petals to defend our lawns.</p>
                <p id="credits-thanks-3">To the zombies, for being such persistent (if slow-moving) adversaries.</p>
                <p id="credits-thanks-4">And to you, the player, for joining this crazy adventure!</p>
                
                <h3 id="credits-disclaimer">Disclaimer</h3>
                <p id="credits-disclaimer-text">This is a fan-made project created for educational and entertainment purposes. Plants vs. Zombies is a trademark of PopCap Games, Inc. This project is not officially affiliated with or endorsed by PopCap Games.</p>
                
                <h3 id="credits-contact">Contact</h3>
                <p id="credits-contact-text">If you enjoyed this interactive story, feel free to share it with your friends!</p>
            </div>
        </div>
        <div class="navigation">
            <button class="nav-button" onclick="showScreen('main-menu')" id="credits-back">Back to Menu</button>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="floating-button" onclick="showScreen('main-menu')" style="display: none;">‚ò∞</button>

    <!-- Audio Elements -->
    <audio id="bgMusic" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-game-show-suspense-waiting-667.mp3" type="audio/mpeg">
    </audio>
    <audio id="clickSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>
    <audio id="plantSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" type="audio/mpeg">
    </audio>
    <audio id="zombieSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-monster-low-growl-233.mp3" type="audio/mpeg">
    </audio>
    <audio id="sunSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-magic-sparkle-sound-309.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Game state
        let gameState = {
            currentPage: 0,
            sunEnergy: 0,
            zombiesDefeated: 0,
            plantsPlanted: 0,
            totalChoices: 0,
            totalPagesRead: 0,
            gameScore: 0,
            plantCollection: [],
            savedGames: [],
            settings: {
                theme: 'default',
                font: 'Vazirmatn',
                fontSize: 16,
                volumes: {
                    bgMusic: 50,
                    sfx: 70,
                    plants: 80
                },
                autoSave: 'on',
                language: 'en' // Default language
            }
        };

        // Translation dictionary
        const translations = {
            en: {
                // Language selection
                'select-language': 'Select Language',
                'play-english': 'Play in English',
                'play-persian': 'Play in Persian',
                
                // Loading screen
                'loading-title': 'Crazy Dave\'s Adventure',
                'loading-subtitle': 'A Fan Made Text Based Game',
                
                // Main menu
                'main-logo': 'Crazy Dave\'s Adventure',
                'main-subtitle': 'A Fan Made Text Based Game',
                'menu-new-game': 'Start New Adventure',
                'menu-continue': 'Continue Adventure',
                'menu-toc': 'Table of Contents',
                'menu-stats': 'Player Stats',
                'menu-settings': 'Settings',
                'menu-credits': 'Credits',
                'menu-exit': 'Exit',
                
                // Story screen
                'story-title-0': 'Preface: The Calm Before the Storm',
                'story-title-1': 'Introduction: Meet Crazy Dave',
                'story-title-2': 'Chapter 1: The Zombie Invasion Begins!',
                'story-title-3': 'Chapter 2: Meeting the Plant Army',
                'story-title-4': 'Chapter 3: Your First Defense Line',
                'story-title-5': 'Chapter 4: The Wall-nut Strategy',
                'story-title-6': 'Chapter 5: Cherry Bomb Surprise',
                'story-title-7': 'Chapter 6: The Night Shift Begins',
                'story-title-8': 'Chapter 7: Mushroom Allies',
                'story-title-9': 'Chapter 8: Pool Defense Tactics',
                'story-title-10': 'Chapter 9: The Roof Finale',
                'story-title-11': 'Chapter 10: Dr. Zomboss\'s Revenge',
                'story-title-12': 'Epilogue: A Hero\'s Reward',
                'story-title-13': 'Bonus Chapter: The Secret Garden',
                'story-title-14': 'Reviews and Critiques',
                'story-title-15': 'Acknowledgments',
                
                'stat-sun-label': 'Sun Power',
                'stat-zombies-label': 'Zombies Defeated',
                'stat-plants-label': 'Plants Planted',
                'page': 'Page',
                
                // Navigation
                'nav-prev': 'Previous',
                'nav-save': 'Save Game',
                'nav-next': 'Next',
                
                // Stats screen
                'stats-title': 'Player Statistics',
                'total-sun-label': 'Total Sun Collected',
                'total-zombies-label': 'Total Zombies Defeated',
                'total-plants-label': 'Total Plants Planted',
                'total-choices-label': 'Decisions Made',
                'total-pages-label': 'Pages Read',
                'game-score-label': 'Adventure Score',
                'plant-collection-title': 'Plant Collection',
                'stats-back': 'Back to Menu',
                
                // TOC screen
                'toc-title': 'Table of Contents',
                'toc-0': 'Preface: The Calm Before the Storm',
                'toc-1': 'Introduction: Meet Crazy Dave',
                'toc-2': 'Chapter 1: The Zombie Invasion Begins!',
                'toc-3': 'Chapter 2: Meeting the Plant Army',
                'toc-4': 'Chapter 3: Your First Defense Line',
                'toc-5': 'Chapter 4: The Wall-nut Strategy',
                'toc-6': 'Chapter 5: Cherry Bomb Surprise',
                'toc-7': 'Chapter 6: The Night Shift Begins',
                'toc-8': 'Chapter 7: Mushroom Allies',
                'toc-9': 'Chapter 8: Pool Defense Tactics',
                'toc-10': 'Chapter 9: The Roof Finale',
                'toc-11': 'Chapter 10: Dr. Zomboss\'s Revenge',
                'toc-12': 'Epilogue: A Hero\'s Reward',
                'toc-13': 'Bonus Chapter: The Secret Garden',
                'toc-14': 'Reviews and Critiques',
                'toc-15': 'Acknowledgments',
                'toc-back': 'Back to Menu',
                
                // Settings screen
                'settings-title': 'Settings',
                'theme-label': 'Theme:',
                'theme-default': 'Default (Green)',
                'theme-dark': 'Dark Mode',
                'theme-zombie': 'Zombie Theme',
                'font-label': 'Font:',
                'font-vazir': 'Vazirmatn',
                'font-sahel': 'Sahel',
                'font-shabnam': 'Shabnam',
                'font-parastoo': 'Parastoo',
                'font-tanha': 'Tanha',
                'font-gandom': 'Gandom',
                'font-size-label': 'Font Size:',
                'sound-label': 'Sounds:',
                'bg-music-label': 'Background Music:',
                'sfx-label': 'Sound Effects:',
                'plant-sounds-label': 'Plant Sounds:',
                'auto-save-label': 'Auto Save:',
                'auto-save-on': 'Enabled',
                'auto-save-off': 'Disabled',
                'test-sounds': 'Test Sounds',
                'settings-reset': 'Reset Settings',
                'settings-back': 'Back to Menu',
                
                // Credits screen
                'credits-title': 'Credits',
                'credits-game-title': 'Plants vs. Zombies: Crazy Dave\'s Adventure',
                'credits-desc': 'An interactive storybook experience based on the popular game Plants vs. Zombies by PopCap Games.',
                'credits-dev-team': 'Sorena Rahmanzadeh',
                'credits-story': 'Story & Design: Fan Development Team',
                'credits-programming': 'Programming: Fan Development Team',
                'credits-art': 'Art Direction: Fan Development Team',
                'credits-thanks': 'Special Thanks',
                'credits-thanks-1': 'To the original creators of Plants vs. Zombies for inspiring this project.',
                'credits-thanks-2': 'To all the plants who bravely gave their petals to defend our lawns.',
                'credits-thanks-3': 'To the zombies, for being such persistent (if slow-moving) adversaries.',
                'credits-thanks-4': 'And to you, the player, for joining this crazy adventure!',
                'credits-disclaimer': 'Disclaimer',
                'credits-disclaimer-text': 'This is a fan-made project created for educational and entertainment purposes. Plants vs. Zombies is a trademark of PopCap Games, Inc. This project is not officially affiliated with or endorsed by PopCap Games.',
                'credits-contact': 'Contact',
                'credits-contact-text': 'If you enjoyed this interactive story, feel free to share it with your friends!',
                'credits-back': 'Back to Menu',
                
                // Language toggle
                'lang-text': 'EN',
                
                // Alerts and messages
                'no-save': 'No saved game found! Starting a new game.',
                'saved': 'Game saved successfully!',
                'reset-confirm': 'Are you sure you want to reset all settings?',
                'exit-confirm': 'Are you sure you want to exit?',
                'exit-thanks': 'Thanks for playing Crazy Dave\'s Adventure!'
            },
            fa: {
                // Language selection
                'select-language': 'ÿßŸÜÿ™ÿÆÿßÿ® ÿ≤ÿ®ÿßŸÜ',
                'play-english': 'ÿ®ÿßÿ≤€å ÿ®Ÿá ÿ≤ÿ®ÿßŸÜ ÿßŸÜ⁄ØŸÑ€åÿ≥€å',
                'play-persian': 'ÿ®ÿßÿ≤€å ÿ®Ÿá ÿ≤ÿ®ÿßŸÜ ŸÅÿßÿ±ÿ≥€å',
                
                // Loading screen
                'loading-title': 'ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá',
                'loading-subtitle': '€å⁄© ÿ®ÿßÿ≤€å ŸÖÿ™ŸÜ€å ÿ≥ÿßÿÆÿ™Ÿá ÿ¥ÿØŸá ÿ™Ÿàÿ≥ÿ∑ ÿ∑ÿ±ŸÅÿØÿßÿ±ÿßŸÜ',
                
                // Main menu
                'main-logo': 'ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá',
                'main-subtitle': '€å⁄© ÿ®ÿßÿ≤€å ŸÖÿ™ŸÜ€å ÿ≥ÿßÿÆÿ™Ÿá ÿ¥ÿØŸá ÿ™Ÿàÿ≥ÿ∑ ÿ∑ÿ±ŸÅÿØÿßÿ±ÿßŸÜ',
                'menu-new-game': 'ÿ¥ÿ±Ÿàÿπ ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å ÿ¨ÿØ€åÿØ',
                'menu-continue': 'ÿßÿØÿßŸÖŸá ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å',
                'menu-toc': 'ŸÅŸáÿ±ÿ≥ÿ™ ŸÖÿ∑ÿßŸÑÿ®',
                'menu-stats': 'ÿ¢ŸÖÿßÿ± ÿ®ÿßÿ≤€å⁄©ŸÜ',
                'menu-settings': 'ÿ™ŸÜÿ∏€åŸÖÿßÿ™',
                'menu-credits': 'ÿ≥ÿßÿ≤ŸÜÿØ⁄ØÿßŸÜ',
                'menu-exit': 'ÿÆÿ±Ÿàÿ¨',
                
                // Story screen
                'story-title-0': 'ŸÖŸÇÿØŸÖŸá: ÿ¢ÿ±ÿßŸÖÿ¥ ŸÇÿ®ŸÑ ÿßÿ≤ ÿ∑ŸàŸÅÿßŸÜ',
                'story-title-1': 'ŸÖÿπÿ±ŸÅ€å: ŸÖŸÑÿßŸÇÿßÿ™ ÿ®ÿß ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá',
                'story-title-2': 'ŸÅÿµŸÑ €±: ÿ≠ŸÖŸÑŸá ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß ÿ¢ÿ∫ÿßÿ≤ ŸÖ€å‚Äåÿ¥ŸàÿØ!',
                'story-title-3': 'ŸÅÿµŸÑ €≤: ŸÖŸÑÿßŸÇÿßÿ™ ÿ®ÿß ÿßÿ±ÿ™ÿ¥ ⁄Ø€åÿßŸáÿßŸÜ',
                'story-title-4': 'ŸÅÿµŸÑ €≥: ÿßŸàŸÑ€åŸÜ ÿÆÿ∑ ÿØŸÅÿßÿπ€å ÿ¥ŸÖÿß',
                'story-title-5': 'ŸÅÿµŸÑ €¥: ÿßÿ≥ÿ™ÿ±ÿßÿ™⁄ò€å ⁄Øÿ±ÿØŸà ÿØ€åŸàÿßÿ±€å',
                'story-title-6': 'ŸÅÿµŸÑ €µ: ÿ≥Ÿàÿ±Ÿæÿ±ÿß€åÿ≤ ÿ®ŸÖÿ® ⁄Ø€åŸÑÿßÿ≥€å',
                'story-title-7': 'ŸÅÿµŸÑ €∂: ÿ¥€åŸÅÿ™ ÿ¥ÿ® ÿ¢ÿ∫ÿßÿ≤ ŸÖ€å‚Äåÿ¥ŸàÿØ',
                'story-title-8': 'ŸÅÿµŸÑ €∑: ŸÖÿ™ÿ≠ÿØÿßŸÜ ŸÇÿßÿ±⁄Ü€å',
                'story-title-9': 'ŸÅÿµŸÑ €∏: ÿ™ÿß⁄©ÿ™€å⁄©‚ÄåŸáÿß€å ÿØŸÅÿßÿπ ÿßÿ≥ÿ™ÿÆÿ±',
                'story-title-10': 'ŸÅÿµŸÑ €π: ŸÅ€åŸÜÿßŸÑ Ÿæÿ¥ÿ™ ÿ®ÿßŸÖ',
                'story-title-11': 'ŸÅÿµŸÑ €±€∞: ÿßŸÜÿ™ŸÇÿßŸÖ ÿØ⁄©ÿ™ÿ± ÿ≤ÿßŸÖÿ®ÿßÿ≥',
                'story-title-12': 'Ÿæ€å ŸÜŸàÿ¥ÿ™: ŸæÿßÿØÿßÿ¥ €å⁄© ŸÇŸáÿ±ŸÖÿßŸÜ',
                'story-title-13': 'ŸÅÿµŸÑ Ÿà€å⁄òŸá: ÿ®ÿßÿ∫ ŸÖÿÆŸÅ€å',
                'story-title-14': 'ÿ®ÿ±ÿ±ÿ≥€å‚ÄåŸáÿß Ÿà ŸÜŸÇÿØŸáÿß',
                'story-title-15': 'ÿ≥Ÿæÿßÿ≥‚Äå⁄Øÿ≤ÿßÿ±€å‚ÄåŸáÿß',
                
                'stat-sun-label': 'ÿßŸÜÿ±⁄ò€å ÿÆŸàÿ±ÿ¥€åÿØ',
                'stat-zombies-label': 'ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß€å ÿ¥⁄©ÿ≥ÿ™ ÿÆŸàÿ±ÿØŸá',
                'stat-plants-label': '⁄Ø€åÿßŸáÿßŸÜ ⁄©ÿßÿ¥ÿ™Ÿá ÿ¥ÿØŸá',
                'page': 'ÿµŸÅÿ≠Ÿá',
                
                // Navigation
                'nav-prev': 'ŸÇÿ®ŸÑ€å',
                'nav-save': 'ÿ∞ÿÆ€åÿ±Ÿá ÿ®ÿßÿ≤€å',
                'nav-next': 'ÿ®ÿπÿØ€å',
                
                // Stats screen
                'stats-title': 'ÿ¢ŸÖÿßÿ± ÿ®ÿßÿ≤€å⁄©ŸÜ',
                'total-sun-label': '⁄©ŸÑ ÿßŸÜÿ±⁄ò€å ÿÆŸàÿ±ÿ¥€åÿØ ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±€å ÿ¥ÿØŸá',
                'total-zombies-label': '⁄©ŸÑ ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß€å ÿ¥⁄©ÿ≥ÿ™ ÿÆŸàÿ±ÿØŸá',
                'total-plants-label': '⁄©ŸÑ ⁄Ø€åÿßŸáÿßŸÜ ⁄©ÿßÿ¥ÿ™Ÿá ÿ¥ÿØŸá',
                'total-choices-label': 'ÿ™ÿµŸÖ€åŸÖÿßÿ™ ⁄Øÿ±ŸÅÿ™Ÿá ÿ¥ÿØŸá',
                'total-pages-label': 'ÿµŸÅÿ≠ÿßÿ™ ÿÆŸàÿßŸÜÿØŸá ÿ¥ÿØŸá',
                'game-score-label': 'ÿßŸÖÿ™€åÿßÿ≤ ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å',
                'plant-collection-title': 'ŸÖÿ¨ŸÖŸàÿπŸá ⁄Ø€åÿßŸáÿßŸÜ',
                'stats-back': 'ÿ®ÿßÿ≤⁄Øÿ¥ÿ™ ÿ®Ÿá ŸÖŸÜŸà',
                
                // TOC screen
                'toc-title': 'ŸÅŸáÿ±ÿ≥ÿ™ ŸÖÿ∑ÿßŸÑÿ®',
                'toc-0': 'ŸÖŸÇÿØŸÖŸá: ÿ¢ÿ±ÿßŸÖÿ¥ ŸÇÿ®ŸÑ ÿßÿ≤ ÿ∑ŸàŸÅÿßŸÜ',
                'toc-1': 'ŸÖÿπÿ±ŸÅ€å: ŸÖŸÑÿßŸÇÿßÿ™ ÿ®ÿß ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá',
                'toc-2': 'ŸÅÿµŸÑ €±: ÿ≠ŸÖŸÑŸá ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß ÿ¢ÿ∫ÿßÿ≤ ŸÖ€å‚Äåÿ¥ŸàÿØ!',
                'toc-3': 'ŸÅÿµŸÑ €≤: ŸÖŸÑÿßŸÇÿßÿ™ ÿ®ÿß ÿßÿ±ÿ™ÿ¥ ⁄Ø€åÿßŸáÿßŸÜ',
                'toc-4': 'ŸÅÿµŸÑ €≥: ÿßŸàŸÑ€åŸÜ ÿÆÿ∑ ÿØŸÅÿßÿπ€å ÿ¥ŸÖÿß',
                'toc-5': 'ŸÅÿµŸÑ €¥: ÿßÿ≥ÿ™ÿ±ÿßÿ™⁄ò€å ⁄Øÿ±ÿØŸà ÿØ€åŸàÿßÿ±€å',
                'toc-6': 'ŸÅÿµŸÑ €µ: ÿ≥Ÿàÿ±Ÿæÿ±ÿß€åÿ≤ ÿ®ŸÖÿ® ⁄Ø€åŸÑÿßÿ≥€å',
                'toc-7': 'ŸÅÿµŸÑ €∂: ÿ¥€åŸÅÿ™ ÿ¥ÿ® ÿ¢ÿ∫ÿßÿ≤ ŸÖ€å‚Äåÿ¥ŸàÿØ',
                'toc-8': 'ŸÅÿµŸÑ €∑: ŸÖÿ™ÿ≠ÿØÿßŸÜ ŸÇÿßÿ±⁄Ü€å',
                'toc-9': 'ŸÅÿµŸÑ €∏: ÿ™ÿß⁄©ÿ™€å⁄©‚ÄåŸáÿß€å ÿØŸÅÿßÿπ ÿßÿ≥ÿ™ÿÆÿ±',
                'toc-10': 'ŸÅÿµŸÑ €π: ŸÅ€åŸÜÿßŸÑ Ÿæÿ¥ÿ™ ÿ®ÿßŸÖ',
                'toc-11': 'ŸÅÿµŸÑ €±€∞: ÿßŸÜÿ™ŸÇÿßŸÖ ÿØ⁄©ÿ™ÿ± ÿ≤ÿßŸÖÿ®ÿßÿ≥',
                'toc-12': 'Ÿæ€å ŸÜŸàÿ¥ÿ™: ŸæÿßÿØÿßÿ¥ €å⁄© ŸÇŸáÿ±ŸÖÿßŸÜ',
                'toc-13': 'ŸÅÿµŸÑ Ÿà€å⁄òŸá: ÿ®ÿßÿ∫ ŸÖÿÆŸÅ€å',
                'toc-14': 'ÿ®ÿ±ÿ±ÿ≥€å‚ÄåŸáÿß Ÿà ŸÜŸÇÿØŸáÿß',
                'toc-15': 'ÿ≥Ÿæÿßÿ≥‚Äå⁄Øÿ≤ÿßÿ±€å‚ÄåŸáÿß',
                'toc-back': 'ÿ®ÿßÿ≤⁄Øÿ¥ÿ™ ÿ®Ÿá ŸÖŸÜŸà',
                
                // Settings screen
                'settings-title': 'ÿ™ŸÜÿ∏€åŸÖÿßÿ™',
                'theme-label': 'ÿ™ŸÖ:',
                'theme-default': 'Ÿæ€åÿ¥‚ÄåŸÅÿ±ÿ∂ (ÿ≥ÿ®ÿ≤)',
                'theme-dark': 'ÿ≠ÿßŸÑÿ™ ÿ™ÿßÿ±€å⁄©',
                'theme-zombie': 'ÿ™ŸÖ ÿ≤ÿßŸÖÿ®€å',
                'font-label': 'ŸÅŸàŸÜÿ™:',
                'font-vazir': 'Ÿàÿ≤€åÿ±ŸÖÿ™ŸÜ',
                'font-sahel': 'ÿ≥ÿßÿ≠ŸÑ',
                'font-shabnam': 'ÿ¥ÿ®ŸÜŸÖ',
                'font-parastoo': 'Ÿæÿ±ÿ≥ÿ™Ÿà',
                'font-tanha': 'ÿ™ŸÜŸáÿß',
                'font-gandom': '⁄ØŸÜÿØŸÖ',
                'font-size-label': 'ÿßŸÜÿØÿßÿ≤Ÿá ŸÅŸàŸÜÿ™:',
                'sound-label': 'ÿµÿØÿßŸáÿß:',
                'bg-music-label': 'ŸÖŸàÿ≥€åŸÇ€å ÿ≤ŸÖ€åŸÜŸá:',
                'sfx-label': 'ÿßŸÅ⁄©ÿ™‚ÄåŸáÿß€å ÿµŸàÿ™€å:',
                'plant-sounds-label': 'ÿµÿØÿßŸáÿß€å ⁄Ø€åÿßŸáÿßŸÜ:',
                'auto-save-label': 'ÿ∞ÿÆ€åÿ±Ÿá ÿÆŸàÿØ⁄©ÿßÿ±:',
                'auto-save-on': 'ŸÅÿπÿßŸÑ',
                'auto-save-off': 'ÿ∫€åÿ±ŸÅÿπÿßŸÑ',
                'test-sounds': 'ÿ™ÿ≥ÿ™ ÿµÿØÿßŸáÿß',
                'settings-reset': 'ÿ®ÿßÿ≤ŸÜÿ¥ÿßŸÜ€å ÿ™ŸÜÿ∏€åŸÖÿßÿ™',
                'settings-back': 'ÿ®ÿßÿ≤⁄Øÿ¥ÿ™ ÿ®Ÿá ŸÖŸÜŸà',
                
                // Credits screen
                'credits-title': 'ÿ≥ÿßÿ≤ŸÜÿØ⁄ØÿßŸÜ',
                'credits-game-title': 'ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá',
                'credits-desc': 'ÿ≥Ÿàÿ±ŸÜÿß ÿ±ÿ≠ŸÖÿßŸÜ ÿ≤ÿßÿØŸá',
                'credits-dev-team': 'ÿ™Ÿàÿ≥ÿπŸá‚ÄåÿØŸáŸÜÿØ⁄ØÿßŸÜ ÿßÿµŸÑ€å',
                'credits-story': 'ÿØÿßÿ≥ÿ™ÿßŸÜ Ÿà ÿ∑ÿ±ÿßÿ≠€å: ÿ™€åŸÖ ÿ™Ÿàÿ≥ÿπŸá‚ÄåÿØŸáŸÜÿØ⁄ØÿßŸÜ ÿ∑ÿ±ŸÅÿØÿßÿ±',
                'credits-programming': 'ÿ®ÿ±ŸÜÿßŸÖŸá‚ÄåŸÜŸà€åÿ≥€å: ÿ™€åŸÖ ÿ™Ÿàÿ≥ÿπŸá‚ÄåÿØŸáŸÜÿØ⁄ØÿßŸÜ ÿ∑ÿ±ŸÅÿØÿßÿ±',
                'credits-art': 'ÿ∑ÿ±ÿßÿ≠€å ŸáŸÜÿ±€å: ÿ™€åŸÖ ÿ™Ÿàÿ≥ÿπŸá‚ÄåÿØŸáŸÜÿØ⁄ØÿßŸÜ ÿ∑ÿ±ŸÅÿØÿßÿ±',
                'credits-thanks': 'ÿ≥Ÿæÿßÿ≥‚Äå⁄Øÿ≤ÿßÿ±€å Ÿà€å⁄òŸá',
                'credits-thanks-1': 'ÿ®ÿß ÿ™ÿ¥⁄©ÿ± ÿßÿ≤ ÿ≥ÿßÿ≤ŸÜÿØ⁄ØÿßŸÜ ÿßÿµŸÑ€å Plants vs. Zombies ÿ®ÿ±ÿß€å ÿßŸÑŸáÿßŸÖ ÿ®ÿÆÿ¥€åÿØŸÜ ÿ®Ÿá ÿß€åŸÜ Ÿæÿ±Ÿà⁄òŸá.',
                'credits-thanks-2': 'ÿ®ÿß ÿ™ÿ¥⁄©ÿ± ÿßÿ≤ ÿ™ŸÖÿßŸÖ ⁄Ø€åÿßŸáÿßŸÜ€å ⁄©Ÿá ÿ¥ÿ¨ÿßÿπÿßŸÜŸá ⁄ØŸÑÿ®ÿ±⁄Ø‚ÄåŸáÿß€å ÿÆŸàÿØ ÿ±ÿß ÿ®ÿ±ÿß€å ÿØŸÅÿßÿπ ÿßÿ≤ ⁄ÜŸÖŸÜ‚ÄåŸáÿß€å ŸÖÿß ŸÅÿØÿß ⁄©ÿ±ÿØŸÜÿØ.',
                'credits-thanks-3': 'ÿ®ÿß ÿ™ÿ¥⁄©ÿ± ÿßÿ≤ ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß ÿ®ÿ±ÿß€å ÿß€åŸÜ⁄©Ÿá ⁄ÜŸÜ€åŸÜ ÿØÿ¥ŸÖŸÜÿßŸÜ ÿ≥ÿ±ÿ≥ÿÆÿ™€å (ÿß⁄Øÿ±⁄ÜŸá ⁄©ŸÜÿØ) ÿ®ŸàÿØŸÜÿØ.',
                'credits-thanks-4': 'Ÿà ÿ®ÿß ÿ™ÿ¥⁄©ÿ± ÿßÿ≤ ÿ¥ŸÖÿßÿå ÿ®ÿßÿ≤€å⁄©ŸÜÿå ÿ®ÿ±ÿß€å Ÿæ€åŸàÿ≥ÿ™ŸÜ ÿ®Ÿá ÿß€åŸÜ ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å ÿØ€åŸàÿßŸÜŸá!',
                'credits-disclaimer': 'ÿ≥ŸÑÿ® ŸÖÿ≥ÿ¶ŸàŸÑ€åÿ™',
                'credits-disclaimer-text': 'ÿß€åŸÜ €å⁄© Ÿæÿ±Ÿà⁄òŸá ÿ≥ÿßÿÆÿ™Ÿá ÿ¥ÿØŸá ÿ™Ÿàÿ≥ÿ∑ ÿ∑ÿ±ŸÅÿØÿßÿ±ÿßŸÜ ÿ®ÿ±ÿß€å ÿßŸáÿØÿßŸÅ ÿ¢ŸÖŸàÿ≤ÿ¥€å Ÿà ÿ≥ÿ±⁄Øÿ±ŸÖ€å ÿßÿ≥ÿ™. Plants vs. Zombies €å⁄© ÿπŸÑÿßŸÖÿ™ ÿ™ÿ¨ÿßÿ±€å ÿßÿ≤ PopCap Games, Inc. ÿßÿ≥ÿ™. ÿß€åŸÜ Ÿæÿ±Ÿà⁄òŸá ÿ®Ÿá ÿ∑Ÿàÿ± ÿ±ÿ≥ŸÖ€å Ÿàÿßÿ®ÿ≥ÿ™Ÿá ÿ®Ÿá PopCap Games ŸÜ€åÿ≥ÿ™ €åÿß ÿ™Ÿàÿ≥ÿ∑ ÿ¢ŸÜ ÿ™ÿ£€å€åÿØ ŸÜÿ¥ÿØŸá ÿßÿ≥ÿ™.',
                'credits-contact': 'ÿ™ŸÖÿßÿ≥ ÿ®ÿß ŸÖÿß',
                'credits-contact-text': 'ÿß⁄Øÿ± ÿßÿ≤ ÿß€åŸÜ ÿØÿßÿ≥ÿ™ÿßŸÜ ÿ™ÿπÿßŸÖŸÑ€å ŸÑÿ∞ÿ™ ÿ®ÿ±ÿØ€åÿØÿå ÿ¢ŸÜ ÿ±ÿß ÿ®ÿß ÿØŸàÿ≥ÿ™ÿßŸÜ ÿÆŸàÿØ ÿ®Ÿá ÿßÿ¥ÿ™ÿ±ÿß⁄© ÿ®⁄Øÿ∞ÿßÿ±€åÿØ!',
                'credits-back': 'ÿ®ÿßÿ≤⁄Øÿ¥ÿ™ ÿ®Ÿá ŸÖŸÜŸà',
                
                // Language toggle
                'lang-text': 'FA',
                
                // Alerts and messages
                'no-save': 'Ÿá€å⁄Ü ÿ®ÿßÿ≤€å ÿ∞ÿÆ€åÿ±Ÿá‚Äåÿ¥ÿØŸá‚Äåÿß€å Ÿæ€åÿØÿß ŸÜÿ¥ÿØ! ÿØÿ± ÿ≠ÿßŸÑ ÿ¥ÿ±Ÿàÿπ €å⁄© ÿ®ÿßÿ≤€å ÿ¨ÿØ€åÿØ.',
                'saved': 'ÿ®ÿßÿ≤€å ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØ!',
                'reset-confirm': 'ÿ¢€åÿß ŸÖÿ∑ŸÖÿ¶ŸÜ Ÿáÿ≥ÿ™€åÿØ ⁄©Ÿá ŸÖ€å‚ÄåÿÆŸàÿßŸá€åÿØ ŸáŸÖŸá ÿ™ŸÜÿ∏€åŸÖÿßÿ™ ÿ±ÿß ÿ®ÿßÿ≤ŸÜÿ¥ÿßŸÜ€å ⁄©ŸÜ€åÿØÿü',
                'exit-confirm': 'ÿ¢€åÿß ŸÖÿ∑ŸÖÿ¶ŸÜ Ÿáÿ≥ÿ™€åÿØ ⁄©Ÿá ŸÖ€å‚ÄåÿÆŸàÿßŸá€åÿØ ÿßÿ≤ ÿ®ÿßÿ≤€å ÿÆÿßÿ±ÿ¨ ÿ¥Ÿà€åÿØÿü',
                'exit-thanks': 'ÿßÿ≤ ÿ®ÿßÿ≤€å ⁄©ÿ±ÿØŸÜ ÿØÿ± ŸÖÿßÿ¨ÿ±ÿßÿ¨Ÿà€å€å ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá ŸÖÿ™ÿ¥⁄©ÿ±€åŸÖ!'
            }
        };

        // Story content in both languages
        const storyPages = {
            en: [
                {
                    title: "Preface: The Calm Before the Storm",
                    content: "Welcome to Neighborville, the most peaceful town in the whole world! The sun is shining, birds are singing, and flowers are blooming everywhere. But wait... what's that strange groaning sound?",
                    choices: [
                        "Investigate the strange noise",
                        "Ignore it and continue with your gardening",
                        "Call the local authorities"
                    ],
                    character: "üè°"
                },
                {
                    title: "Introduction: Meet Crazy Dave",
                    content: "Oh no! Zombies are coming from the west! They're slowly shuffling toward your house, and they look hungry... for brains! Suddenly, your eccentric neighbor Crazy Dave appears in his souped-up convertible. 'Waffles! We need plants! Hungry plants!' he shouts, tossing you a packet of seeds.",
                    choices: [
                        "Take the seeds and thank Dave",
                        "Tell Dave his waffle is burning",
                        "Decide it's time to leave town"
                    ],
                    character: "üßî"
                },
                {
                    title: "Chapter 1: The Zombie Invasion Begins!",
                    content: "The zombies are real! They're slowly moving toward your house, humming 'Fresh brains... fresh brains...' Crazy Dave yells: 'It's time for action! Plant these seeds! But be careful, some of them might... bite back!'",
                    choices: [
                        "Plant the first seed that looks like a sunflower",
                        "Try the weird seed that seems to be yawning",
                        "Ask Dave if there's a better way than fighting"
                    ],
                    character: "üåª"
                }
                // More chapters would be added here in a full implementation
            ],
            fa: [
                {
                    title: "ŸÖŸÇÿØŸÖŸá: ÿ¢ÿ±ÿßŸÖÿ¥ ŸÇÿ®ŸÑ ÿßÿ≤ ÿ∑ŸàŸÅÿßŸÜ",
                    content: "ÿ®Ÿá ŸÜŸê€åÿ®Ÿéÿ±Ÿà€åŸÑ ÿÆŸàÿ¥ ÿ¢ŸÖÿØ€åÿØÿå ÿ¢ÿ±ÿßŸÖ‚Äåÿ™ÿ±€åŸÜ ÿ¥Ÿáÿ± ÿØÿ± ⁄©ŸÑ ÿØŸÜ€åÿß! ÿÆŸàÿ±ÿ¥€åÿØ ŸÖ€å‚ÄåÿØÿ±ÿÆÿ¥ÿØÿå Ÿæÿ±ŸÜÿØ⁄ØÿßŸÜ ÿ¢Ÿàÿßÿ≤ ŸÖ€å‚ÄåÿÆŸàÿßŸÜŸÜÿØ Ÿà ⁄ØŸÑ‚ÄåŸáÿß ÿØÿ± ŸáŸÖŸá ÿ¨ÿß ÿ¥⁄©ŸàŸÅÿß ÿ¥ÿØŸá‚ÄåÿßŸÜÿØ. ÿßŸÖÿß ÿµÿ®ÿ± ⁄©ŸÜ€åÿØ... ÿß€åŸÜ ÿµÿØÿß€å ŸÜÿßŸÑŸá ÿπÿ¨€åÿ® ⁄Ü€åÿ≥ÿ™ÿü",
                    choices: [
                        "ÿ®ÿ±ÿ±ÿ≥€å ÿµÿØÿß€å ÿπÿ¨€åÿ®",
                        "ŸÜÿßÿØ€åÿØŸá ⁄Øÿ±ŸÅÿ™ŸÜ Ÿà ÿßÿØÿßŸÖŸá ÿ®ÿßÿ∫ÿ®ÿßŸÜ€å",
                        "ÿ™ŸÖÿßÿ≥ ÿ®ÿß ŸÖŸÇÿßŸÖÿßÿ™ ŸÖÿ≠ŸÑ€å"
                    ],
                    character: "üè°"
                },
                {
                    title: "ŸÖÿπÿ±ŸÅ€å: ŸÖŸÑÿßŸÇÿßÿ™ ÿ®ÿß ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá",
                    content: "ÿßŸàŸá ŸÜŸá! ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß ÿßÿ≤ ÿ≥ŸÖÿ™ ÿ∫ÿ±ÿ® ŸÖ€å‚Äåÿ¢€åŸÜÿØ! ÿ¢ŸÜ‚ÄåŸáÿß ÿ®Ÿá ÿ¢ÿ±ÿßŸÖ€å ÿ®Ÿá ÿ≥ŸÖÿ™ ÿÆÿßŸÜŸá ÿ¥ŸÖÿß ÿ≠ÿ±⁄©ÿ™ ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ Ÿà ⁄Øÿ±ÿ≥ŸÜŸá ÿ®Ÿá ŸÜÿ∏ÿ± ŸÖ€å‚Äåÿ±ÿ≥ŸÜÿØ... ÿ®ÿ±ÿß€å ŸÖÿ∫ÿ≤! ŸÜÿß⁄ØŸáÿßŸÜÿå ŸáŸÖÿ≥ÿß€åŸá ÿπÿ¨€åÿ® Ÿà ÿ∫ÿ±€åÿ® ÿ¥ŸÖÿß ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá ÿØÿ± ŸÖÿßÿ¥€åŸÜ ÿ™€åŸàŸÜ‚Äåÿ¢Ÿæ ÿÆŸàÿØ ÿ∏ÿßŸáÿ± ŸÖ€å‚Äåÿ¥ŸàÿØ. 'ŸàÿßŸÅŸÑ! ŸÖÿß ÿ®Ÿá ⁄Ø€åÿßŸáÿßŸÜ ŸÜ€åÿßÿ≤ ÿØÿßÿ±€åŸÖ! ⁄Ø€åÿßŸáÿßŸÜ ⁄Øÿ±ÿ≥ŸÜŸá!' ÿßŸà ŸÅÿ±€åÿßÿØ ŸÖ€å‚Äåÿ≤ŸÜÿØ Ÿà €å⁄© ÿ®ÿ≥ÿ™Ÿá ÿ®ÿ∞ÿ± ÿ®Ÿá ÿ≥ŸÖÿ™ ÿ¥ŸÖÿß Ÿæÿ±ÿ™ÿßÿ® ŸÖ€å‚Äå⁄©ŸÜÿØ.",
                    choices: [
                        "ÿ®ÿ∞ÿ±Ÿáÿß ÿ±ÿß ÿ®ÿ±ÿØÿßÿ±€åÿØ Ÿà ÿßÿ≤ ÿØ€åŸà ÿ™ÿ¥⁄©ÿ± ⁄©ŸÜ€åÿØ",
                        "ÿ®Ÿá ÿØ€åŸà ÿ®⁄ØŸà€å€åÿØ ⁄©Ÿá ŸàÿßŸÅŸÑÿ¥ ÿØÿßÿ±ÿØ ŸÖ€å‚Äåÿ≥Ÿàÿ≤ÿØ",
                        "ÿ™ÿµŸÖ€åŸÖ ÿ®⁄Ø€åÿ±€åÿØ ⁄©Ÿá ŸàŸÇÿ™ ÿ¢ŸÜ ÿ±ÿ≥€åÿØŸá ⁄©Ÿá ÿ¥Ÿáÿ± ÿ±ÿß ÿ™ÿ±⁄© ⁄©ŸÜ€åÿØ"
                    ],
                    character: "üßî"
                },
                {
                    title: "ŸÅÿµŸÑ €±: ÿ≠ŸÖŸÑŸá ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß ÿ¢ÿ∫ÿßÿ≤ ŸÖ€å‚Äåÿ¥ŸàÿØ!",
                    content: "ÿ≤ÿßŸÖÿ®€å‚ÄåŸáÿß ŸàÿßŸÇÿπ€å Ÿáÿ≥ÿ™ŸÜÿØ! ÿ¢ŸÜ‚ÄåŸáÿß ÿ®Ÿá ÿ¢ÿ±ÿßŸÖ€å ÿ®Ÿá ÿ≥ŸÖÿ™ ÿÆÿßŸÜŸá ÿ¥ŸÖÿß ÿ≠ÿ±⁄©ÿ™ ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ Ÿà ÿ¢ŸáŸÜ⁄Ø 'ŸÖÿ∫ÿ≤Ÿáÿß€å ÿ™ÿßÿ≤Ÿá... ŸÖÿ∫ÿ≤Ÿáÿß€å ÿ™ÿßÿ≤Ÿá...' ÿ±ÿß ÿ≤ŸÖÿ≤ŸÖŸá ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ. ÿØ€åŸà ÿØ€åŸàÿßŸÜŸá ŸÅÿ±€åÿßÿØ ŸÖ€å‚Äåÿ≤ŸÜÿØ: 'ÿ≤ŸÖÿßŸÜ ÿπŸÖŸÑ ŸÅÿ±ÿß ÿ±ÿ≥€åÿØŸá! ÿß€åŸÜ ÿ®ÿ∞ÿ±Ÿáÿß ÿ±ÿß ÿ®⁄©ÿßÿ±! ÿßŸÖÿß ŸÖÿ±ÿßŸÇÿ® ÿ®ÿßÿ¥ÿå ÿ®ÿπÿ∂€å ÿßÿ≤ ÿ¢ŸÜ‚ÄåŸáÿß ⁄©ŸÖ€å... ⁄Øÿßÿ≤ ŸÖ€å‚Äå⁄Ø€åÿ±ŸÜÿØ!'",
                    choices: [
                        "ÿßŸàŸÑ€åŸÜ ÿ®ÿ∞ÿ± ÿ±ÿß ⁄©Ÿá ÿ¥ÿ®€åŸá ⁄ØŸÑ ÿ¢ŸÅÿ™ÿßÿ®‚Äå⁄Øÿ±ÿØÿßŸÜ ÿßÿ≥ÿ™ ÿ®⁄©ÿßÿ±€åÿØ",
                        "ÿ®ÿ∞ÿ± ÿπÿ¨€åÿ®€å ⁄©Ÿá ÿ®Ÿá ŸÜÿ∏ÿ± ŸÖ€å‚Äåÿ±ÿ≥ÿØ ÿÆŸÖ€åÿßÿ≤Ÿá ŸÖ€å‚Äå⁄©ÿ¥ÿØ ÿ±ÿß ÿßŸÖÿ™ÿ≠ÿßŸÜ ⁄©ŸÜ€åÿØ",
                        "ÿßÿ≤ ÿØ€åŸà ÿ®Ÿæÿ±ÿ≥€åÿØ ÿ¢€åÿß ÿ±ÿßŸá ÿ®Ÿáÿ™ÿ±€å ÿ¨ÿ≤ ÿ¨ŸÜ⁄Ø€åÿØŸÜ Ÿàÿ¨ŸàÿØ ÿØÿßÿ±ÿØ"
                    ],
                    character: "üåª"
                }
                // More chapters would be added here in a full implementation
            ]
        };

        // Initialize the game
        function initGame() {
            // Load saved game if exists
            loadGame();
            
            // Apply loaded settings
            changeTheme(gameState.settings.theme);
            changeFont(gameState.settings.font);
            changeFontSize(gameState.settings.fontSize);
            document.getElementById('theme-select').value = gameState.settings.theme;
            document.getElementById('font-size').value = gameState.settings.fontSize;
            document.getElementById('auto-save').value = gameState.settings.autoSave;
            
            // Update volume sliders
            document.getElementById('bg-music').value = gameState.settings.volumes.bgMusic;
            document.getElementById('sfx-volume').value = gameState.settings.volumes.sfx;
            document.getElementById('plant-sounds').value = gameState.settings.volumes.plants;
            document.getElementById('bg-music-value').textContent = `${gameState.settings.volumes.bgMusic}%`;
            document.getElementById('sfx-volume-value').textContent = `${gameState.settings.volumes.sfx}%`;
            document.getElementById('plant-sounds-value').textContent = `${gameState.settings.volumes.plants}%`;
            
            // Apply language
            applyLanguage(gameState.settings.language);
        }

        // Language selection
        function selectLanguage(lang) {
            gameState.settings.language = lang;
            applyLanguage(lang);
            
            // Hide language screen and show loading screen
            document.getElementById('language-screen').style.display = 'none';
            document.getElementById('loading-screen').style.display = 'flex';
            
            // Simulate loading
            setTimeout(() => {
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('main-menu').style.display = 'block';
                document.querySelector('.floating-button').style.display = 'flex';
                document.querySelector('.language-toggle').style.display = 'flex';
                
                // Start background music
                playSound('bgMusic');
            }, 5000);
            
            // Animate the zombie head during loading
            const zombieHead = document.querySelector('.zombie-head');
            zombieHead.style.left = '100%';
            
            // Initialize the game
            initGame();
        }

        // Apply language to the UI
        function applyLanguage(lang) {
            const t = translations[lang];
            
            // Update body class for RTL/LTR
            if (lang === 'fa') {
                document.body.classList.remove('english');
                document.body.classList.add('persian');
            } else {
                document.body.classList.remove('persian');
                document.body.classList.add('english');
            }
            
            // Update all translatable elements
            for (const [key, value] of Object.entries(t)) {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = value;
                }
            }
            
            // Update language toggle
            document.getElementById('lang-flag').textContent = lang === 'en' ? 'üá∫üá∏' : 'üáÆüá∑';
            
            // Update story if we're on the story screen
            if (document.getElementById('story-screen').style.display === 'block') {
                updateStoryDisplay();
            }
            
            // Save settings
            saveSettings();
        }

        // Toggle language
        function toggleLanguage() {
            const newLang = gameState.settings.language === 'en' ? 'fa' : 'en';
            gameState.settings.language = newLang;
            applyLanguage(newLang);
        }

        // Audio functions
        function playSound(soundId) {
            const sound = document.getElementById(soundId);
            if (sound && gameState.settings.volumes[soundId] > 0) {
                sound.volume = gameState.settings.volumes[soundId] / 100;
                sound.currentTime = 0;
                sound.play().catch(e => console.log("Audio play failed:", e));
            }
        }

        function changeVolume(soundType, value) {
            gameState.settings.volumes[soundType] = parseInt(value);
            
            // Update display
            document.getElementById(`${soundType}-value`).textContent = `${value}%`;
            
            // Update audio elements
            if (soundType === 'bgMusic') {
                document.getElementById('bgMusic').volume = value / 100;
            }
            
            // Save settings
            saveSettings();
        }

        function testSounds() {
            playSound('clickSound');
            setTimeout(() => playSound('plantSound'), 300);
            setTimeout(() => playSound('zombieSound'), 600);
            setTimeout(() => playSound('sunSound'), 900);
        }

        // Font functions
        function changeFont(fontName) {
            document.documentElement.style.setProperty('--font-main', fontName);
            gameState.settings.font = fontName;
            
            // Update active font option
            document.querySelectorAll('.font-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.classList.add('active');
            
            saveSettings();
        }

        function changeFontSize(size) {
            document.body.style.fontSize = `${size}px`;
            document.getElementById('font-size-value').textContent = `${size}px`;
            gameState.settings.fontSize = parseInt(size);
            saveSettings();
        }

        // Show specific screen
        function showScreen(screenId) {
            playSound('clickSound');
            
            // Hide all screens
            const screens = document.querySelectorAll('.container');
            screens.forEach(screen => {
                screen.style.display = 'none';
            });
            
            // Show requested screen
            document.getElementById(screenId).style.display = 'block';
            
            // Update stats if showing stats screen
            if (screenId === 'stats-screen') {
                updateStatsDisplay();
            }
        }

        // Start a new game
        function startNewGame() {
            playSound('clickSound');
            
            // Reset game state
            gameState.currentPage = 0;
            gameState.sunEnergy = 50;
            gameState.zombiesDefeated = 0;
            gameState.plantsPlanted = 0;
            gameState.totalChoices = 0;
            gameState.totalPagesRead = 1;
            gameState.gameScore = 0;
            gameState.plantCollection = ['üåª', 'ü•ú'];
            
            // Update story display
            updateStoryDisplay();
            
            // Show story screen
            showScreen('story-screen');
        }

        // Continue saved game
        function continueGame() {
            playSound('clickSound');
            
            if (gameState.savedGames.length > 0) {
                // Load the latest saved game
                const latestSave = gameState.savedGames[gameState.savedGames.length - 1];
                gameState = {...gameState, ...latestSave};
                
                // Update story display
                updateStoryDisplay();
                
                // Show story screen
                showScreen('story-screen');
            } else {
                alert(translations[gameState.settings.language]['no-save']);
                startNewGame();
            }
        }

        // Update the story display
        function updateStoryDisplay() {
            const lang = gameState.settings.language;
            const currentPageData = storyPages[lang][gameState.currentPage];
            
            document.getElementById('story-title').textContent = currentPageData.title;
            document.getElementById('story-content').innerHTML = `
                <div class="character-image">${currentPageData.character}</div>
                <p>${currentPageData.content}</p>
            `;
            
            // Update choices
            const choicesContainer = document.getElementById('story-choices');
            choicesContainer.innerHTML = '';
            
            currentPageData.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = 'choice-button';
                button.textContent = choice;
                button.onclick = () => makeChoice(index);
                choicesContainer.appendChild(button);
            });
            
            // Update page number
            const t = translations[gameState.settings.language];
            document.getElementById('current-page').textContent = gameState.currentPage + 1;
            document.querySelector('.page-number').innerHTML = `${t['page']} <span id="current-page">${gameState.currentPage + 1}</span>`;
            
            // Update current stats
            document.getElementById('stat-sun').textContent = gameState.sunEnergy;
            document.getElementById('stat-zombies').textContent = gameState.zombiesDefeated;
            document.getElementById('stat-plants').textContent = gameState.plantsPlanted;
        }

        // Make a choice
        function makeChoice(choiceIndex) {
            playSound('plantSound');
            
            // Update game state based on choice
            gameState.totalChoices++;
            gameState.sunEnergy += Math.floor(Math.random() * 10) + 5;
            gameState.zombiesDefeated += Math.floor(Math.random() * 3);
            gameState.plantsPlanted += Math.floor(Math.random() * 2) + 1;
            gameState.gameScore += (choiceIndex + 1) * 10;
            
            // Add random plant to collection occasionally
            if (Math.random() > 0.7) {
                const plants = ['üåª', 'ü•ú', 'üçí', 'üçÑ', 'üåä', 'üõ°Ô∏è', 'üîÆ'];
                const newPlant = plants[Math.floor(Math.random() * plants.length)];
                if (!gameState.plantCollection.includes(newPlant)) {
                    gameState.plantCollection.push(newPlant);
                    playSound('sunSound');
                }
            }
            
            // Play zombie sound occasionally
            if (Math.random() > 0.5) {
                playSound('zombieSound');
            }
            
            // Move to next page
            if (gameState.currentPage < storyPages[gameState.settings.language].length - 1) {
                gameState.currentPage++;
                gameState.totalPagesRead++;
            }
            
            // Update display
            updateStoryDisplay();
            
            // Auto-save if enabled
            if (gameState.settings.autoSave === 'on') {
                saveGame();
            }
        }

        // Go to next page
        function nextPage() {
            playSound('clickSound');
            
            if (gameState.currentPage < storyPages[gameState.settings.language].length - 1) {
                gameState.currentPage++;
                gameState.totalPagesRead++;
                updateStoryDisplay();
            }
        }

        // Go to previous page
        function previousPage() {
            playSound('clickSound');
            
            if (gameState.currentPage > 0) {
                gameState.currentPage--;
                updateStoryDisplay();
            }
        }

        // Go to specific page
        function goToPage(pageIndex) {
            playSound('clickSound');
            
            if (pageIndex >= 0 && pageIndex < storyPages[gameState.settings.language].length) {
                gameState.currentPage = pageIndex;
                updateStoryDisplay();
                showScreen('story-screen');
            }
        }

        // Save the game
        function saveGame() {
            playSound('clickSound');
            
            // Create save data
            const saveData = {
                currentPage: gameState.currentPage,
                sunEnergy: gameState.sunEnergy,
                zombiesDefeated: gameState.zombiesDefeated,
                plantsPlanted: gameState.plantsPlanted,
                totalChoices: gameState.totalChoices,
                totalPagesRead: gameState.totalPagesRead,
                gameScore: gameState.gameScore,
                plantCollection: [...gameState.plantCollection],
                saveDate: new Date().toLocaleString()
            };
            
            // Add to saved games
            gameState.savedGames.push(saveData);
            
            // Keep only last 5 saves
            if (gameState.savedGames.length > 5) {
                gameState.savedGames.shift();
            }
            
            // Save to localStorage
            localStorage.setItem('crazyDaveAdventureSave', JSON.stringify(gameState));
            
            // Show save confirmation
            const saveButton = document.querySelector('.nav-button:nth-child(2)');
            const originalText = saveButton.textContent;
            saveButton.textContent = translations[gameState.settings.language]['saved'];
            setTimeout(() => {
                saveButton.textContent = originalText;
            }, 1000);
        }

        // Load the game
        function loadGame() {
            const savedGame = localStorage.getItem('crazyDaveAdventureSave');
            if (savedGame) {
                const loadedState = JSON.parse(savedGame);
                
                // Merge with current state to preserve settings
                gameState = {...gameState, ...loadedState};
            }
        }

        // Save settings
        function saveSettings() {
            localStorage.setItem('crazyDaveAdventureSave', JSON.stringify(gameState));
        }

        // Update stats display
        function updateStatsDisplay() {
            document.getElementById('total-sun').textContent = gameState.sunEnergy;
            document.getElementById('total-zombies').textContent = gameState.zombiesDefeated;
            document.getElementById('total-plants').textContent = gameState.plantsPlanted;
            document.getElementById('total-choices').textContent = gameState.totalChoices;
            document.getElementById('total-pages').textContent = gameState.totalPagesRead;
            document.getElementById('game-score').textContent = gameState.gameScore;
            
            // Update plant collection
            const plantCollectionContainer = document.getElementById('plant-collection');
            plantCollectionContainer.innerHTML = '';
            
            gameState.plantCollection.forEach(plant => {
                const plantElement = document.createElement('span');
                plantElement.style.fontSize = '2rem';
                plantElement.style.margin = '5px';
                plantElement.textContent = plant;
                plantCollectionContainer.appendChild(plantElement);
            });
        }

        // Change theme
        function changeTheme(theme) {
            document.body.className = '';
            if (theme !== 'default') {
                document.body.classList.add(`theme-${theme}`);
            }
            gameState.settings.theme = theme;
            saveSettings();
        }

        // Toggle auto-save
        function toggleAutoSave(autoSave) {
            gameState.settings.autoSave = autoSave;
            saveSettings();
        }

        // Reset settings
        function resetSettings() {
            playSound('clickSound');
            
            const t = translations[gameState.settings.language];
            if (confirm(t['reset-confirm'])) {
                gameState.settings = {
                    theme: 'default',
                    font: 'Vazirmatn',
                    fontSize: 16,
                    volumes: {
                        bgMusic: 50,
                        sfx: 70,
                        plants: 80
                    },
                    autoSave: 'on',
                    language: gameState.settings.language
                };
                
                // Apply reset settings
                changeTheme('default');
                changeFont('Vazirmatn');
                changeFontSize(16);
                toggleAutoSave('on');
                
                // Reset UI elements
                document.getElementById('theme-select').value = 'default';
                document.getElementById('font-size').value = 16;
                document.getElementById('auto-save').value = 'on';
                
                // Reset volume sliders
                document.getElementById('bg-music').value = 50;
                document.getElementById('sfx-volume').value = 70;
                document.getElementById('plant-sounds').value = 80;
                document.getElementById('bg-music-value').textContent = '50%';
                document.getElementById('sfx-volume-value').textContent = '70%';
                document.getElementById('plant-sounds-value').textContent = '80%';
                
                // Update active font option
                document.querySelectorAll('.font-option').forEach(option => {
                    option.classList.remove('active');
                });
                document.querySelector('.font-option').classList.add('active');
                
                alert('Settings have been reset.');
            }
        }

        // Exit the app
        function exitApp() {
            playSound('clickSound');
            
            const t = translations[gameState.settings.language];
            if (confirm(t['exit-confirm'])) {
                alert(t['exit-thanks']);
                // In a real app, this would close the window
            }
        }
    </script>
</body>
</html>